{"version":3,"sources":["webpack:///./src/actions/types.js","webpack:///./src/services/api.js","webpack:///./src/actions/user.js","webpack:///./src/locales/index.js","webpack:///./src/locales/en.js","webpack:///./src/locales/es.js","webpack:///./src/services/firstInteraction.js","webpack:///./src/reducers/room.js","webpack:///./src/reducers/rooms.js","webpack:///./src/reducers/user.js","webpack:///./src/reducers/index.js","webpack:///./src/components/room/video.jsx","webpack:///./src/layout/settings.jsx","webpack:///./src/layout/user.jsx","webpack:///./src/layout/index.jsx","webpack:///./src/components/room/canvas.jsx","webpack:///./src/components/room/events.js","webpack:///./src/actions/room.js","webpack:///./src/components/room/peers.jsx","webpack:///./src/routes/room.jsx","webpack:///./src/routes/rooms.jsx","webpack:///./src/actions/rooms.js","webpack:///./src/components/ui/button.js","webpack:///./src/routes/login.jsx","webpack:///./src/routes/404.jsx","webpack:///./src/routes/index.jsx","webpack:///./src/index.jsx"],"names":["USER_HIDE_SETTINGS","USER_REFRESH_SESSION_FULFILLED","USER_REFRESH_SESSION_REJECTED","USER_SAVE_SETTINGS","USER_SHOW_SETTINGS","USER_SIGNOUT","USER_START_STREAM","USER_TOGGLE_AUDIO","ROOM_ADD_PHOTO","ROOM_JOIN","ROOM_PEER_JOIN","ROOM_PEER_LEAVE","ROOM_PEER_POINTER","ROOM_PEER_SIGNAL","ROOM_PEER_STREAM","ROOM_MOVE_PHOTO","ROOM_REMOVE_PHOTO","ROOM_RESET","api","API","_classCallCheck","this","baseURL","__API__","body","_ref","endpoint","_ref$headers","headers","_ref$method","method","authorization","Authorization","FormData","JSON","stringify","fetch","concat","then","res","status","Error","get","split","arrayBuffer","json","token","refreshSession","session","type","types","payload","dispatch","catch","locales","en","NotFound","description","goBack","Room","joining","welcome","Rooms","peers","User","audioInput","settings","saveSettings","signIn","videoInput","es","availableLocales","Object","keys","translations","forEach","locale","merge","firstInteraction","FirstInteraction","firstInteraction_classCallCheck","promises","getPromise","bind","onKey","onPointer","touches","Touches","window","filtered","preventSimulated","on","addEventListener","isReady","Promise","resolve","push","disable","removeEventListener","onFirstInteraction","roomReducer","combineReducers","name","state","arguments","length","undefined","action","connection","destroy","room_toConsumableArray","peer","filter","_ref2","map","_objectSpread","pointer","_ref3","signal","video","document","createElement","srcObject","stream","onloadedmetadata","WaitForFirstInteraction","play","_ref4","addStream","_ref5","photos","photo","_id","origin","x","y","_ref6","socket","roomsReducer","list","sort","a","b","localeCompare","localStoreKeyPrefix","sessionKey","storedSession","parse","localStorage","getItem","setAuthorization","userReducer","isAudioMuted","isAuth","isShowingSettings","profile","_action$payload","setItem","getTracks","track","stop","getAudioTracks","enabled","removeItem","muted","rootReducer","i18n","loadingBar","room","rooms","user","Video","props","_this","video_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","call","dom","React","createRef","Component","current","appendChild","react_default","ref","propTypes","PropTypes","object","isRequired","Overlay","styled","div","withConfig","displayName","componentId","Wrapper","Heading","h2","Form","form","Settings","settings_classCallCheck","settings_getPrototypeOf","onSubmit","settings_assertThisInitialized","PureComponent","_this2","navigator","mediaDevices","enumerateDevices","devices","audioInputs","kind","videoInputs","setState","e","_this$props","hide","save","preventDefault","target","value","_this$props2","_this$props2$settings","_this$state","react_redux_i18n_build","onClick","ti","defaultValue","deviceId","label","key","className","shape","string","func","connect","showSettings","signout","toggleAudio","user_Wrapper","getVideoTracks","room_video","src","layout_settings","bool","oneOfType","_ref2$user","Route","loadingBarStyle","backgroundColor","Layout","children","build_default","style","layout_user","layout_Route","node","Canvas","canvas_classCallCheck","canvas_getPrototypeOf","onDrop","canvas_assertThisInitialized","onPointerWheel","onResize","scale","canvas","loadPhotos","onDragOver","onPointerStart","onPointerMove","onPointerEnd","addWheelListener","draw","removeWheelListener","clientX","clientY","file","_slicedToArray","dataTransfer","files","getPointer","reader","FileReader","onload","send","result","substr","indexOf","readAsDataURL","button","_this$getPointer","intersects","image","width","height","reverse","dragging","shiftKey","offset","_this$getPointer2","_channel","readyState","Int32Array","_dragging$photo","deltaY","normalized","Math","min","max","innerWidth","innerHeight","round","_this3","_ref7","img","Image","_ref8","_this4","_ref9","ctx","getContext","translate","textAlign","textBaseline","fillStyle","font","fillText","I18n","t","_ref10","drawImage","_ref11","_pointer","radius","beginPath","arc","PI","fill","clip","restore","arrayOf","number","_ref12","_ref12$room","Events","events_classCallCheck","events_getPrototypeOf","onMessage","events_assertThisInitialized","slug","match","params","_this$props$settings","startStream","connectToServer","getUserMedia","audio","exact","events_objectSpread","facingMode","currentSlug","reset","_this$props3","hideLoading","WebSocket","CONNECTING","close","event","data","_this$props4","addPhoto","history","join","movePhoto","peerJoin","peerLeave","peerSignal","removePhoto","connectToPeer","replace","_this$props5","showLoading","onopen","onclose","onerror","onmessage","initiator","_this$props6","peerPointer","peerStream","Peer","buffer","events_toConsumableArray","withRouter","_ref4$user","getState","Listing","Peers","room_canvas","events","components_room_peers","rooms_Listing","flag","peerLimit","Link","to","pathname","__COUNTRY_FLAGS_CDN__","count","limit","primary","Box","Login","login_classCallCheck","login_getPrototypeOf","loginWithGoogle","login_assertThisInitialized","popupWatcher","clearInterval","screenX","screenY","left","screen","w","top","h","win","open","setInterval","postMessage","login_Wrapper","ui_button","Status","Description","Alternative","_404_Wrapper","store","storedLocale","browserLocale","component","requiresAuth","requiresNoAuth","rest","_objectWithoutProperties","isForbidden","_extends","render","Redirect","Root","layout","Switch","routes_Route","path","from","compose","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","productionCompose","createStore","applyMiddleware","thunkMiddleware","promiseMiddleware","loadingBarMiddleware","languages","language","browserLanguage","userLanguage","toLowerCase","syncTranslationWithStore","loadTranslations","setLocale","createHashHistory","basename","__BASENAME__","mount","getElementById","react_redux_es","Router","routes"],"mappings":"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","file":"code/main.4e865610f8951c953a4d.js","sourcesContent":["export const USER_HIDE_SETTINGS = 'USER/HIDE_SETTINGS';\nexport const USER_REFRESH_SESSION = 'USER/REFRESH_SESSION';\nexport const USER_REFRESH_SESSION_FULFILLED = 'USER/REFRESH_SESSION_FULFILLED';\nexport const USER_REFRESH_SESSION_REJECTED = 'USER/REFRESH_SESSION_REJECTED';\nexport const USER_SAVE_SETTINGS = 'USER/SAVE_SETTINGS';\nexport const USER_SHOW_SETTINGS = 'USER/SHOW_SETTINGS';\nexport const USER_SIGNOUT = 'USER/SIGNOUT';\nexport const USER_START_STREAM = 'USER/START_STREAM';\nexport const USER_TOGGLE_AUDIO = 'SESSION/TOGGLE_AUDIO';\nexport const ROOM_ADD_PHOTO = 'ROOM/ADD_PHOTO';\nexport const ROOM_ERROR = 'ROOM/ERROR';\nexport const ROOM_JOIN = 'ROOM/JOIN';\nexport const ROOM_PEER_JOIN = 'ROOM/PEER_JOIN';\nexport const ROOM_PEER_LEAVE = 'ROOM/PEER_LEAVE';\nexport const ROOM_PEER_POINTER = 'ROOM/PEER_POINTER';\nexport const ROOM_PEER_SIGNAL = 'ROOM/PEER_SIGNAL';\nexport const ROOM_PEER_STREAM = 'ROOM/PEER_STREAM';\nexport const ROOM_MOVE_PHOTO = 'ROOM/MOVE_PHOTO';\nexport const ROOM_REMOVE_PHOTO = 'ROOM/REMOVE_PHOTO';\nexport const ROOM_RESET = 'ROOM/RESET';\nexport const ROOMS_FETCH = 'ROOMS/FETCH';\nexport const ROOMS_FETCH_FULFILLED = 'ROOMS/FETCH_FULFILLED';\n","class API {\n  constructor() {\n    this.baseURL = __API__;\n  }\n\n  fetch({\n    body,\n    endpoint,\n    headers = {},\n    method = 'GET',\n  }) {\n    const {\n      authorization,\n      baseURL,\n    } = this;\n    if (authorization) {\n      headers.Authorization = authorization;\n    }\n    if (body && !(body instanceof FormData)) {\n      body = JSON.stringify(body);\n      headers['Content-Type'] = 'application/json';\n    }\n    return fetch(\n      `${baseURL}${endpoint}`,\n      {\n        body,\n        headers,\n        method,\n      }\n    )\n      .then((res) => {\n        const { headers, status } = res;\n        if (status < 200 || status >= 400) {\n          throw new Error(status);\n        }\n        const type = (headers.get('Content-Type') || '').split(';')[0];\n        switch (type) {\n          case 'text/plain':\n            return res.arrayBuffer();\n          case 'application/json':\n            return res.json();\n          default:\n            return res;\n        }\n      });\n  }\n\n  setAuthorization(token) {\n    if (token) {\n      this.authorization = `Bearer ${token}`;\n    } else {\n      delete this.authorization;\n    }\n    this.token = token;\n  }\n}\n\nexport default new API();\n","import { setLocale as reduxSetLocale } from 'react-redux-i18n';\nimport * as types from './types';\nimport API from '@/services/api';\n\nexport function hideSettings() {\n  return {\n    type: types.USER_HIDE_SETTINGS,\n  };\n}\n\nexport function refreshSession(session) {\n  if (session) {\n    return {\n      type: types.USER_REFRESH_SESSION_FULFILLED,\n      payload: session,\n    };\n  }\n  return dispatch => dispatch({\n    type: types.USER_REFRESH_SESSION,\n    payload: API.fetch({\n      endpoint: 'user',\n    }),\n  }).catch(() => {});\n}\n\nexport function saveSettings({ audioInput, videoInput }) {\n  return {\n    type: types.USER_SAVE_SETTINGS,\n    payload: { audioInput, videoInput },\n  };\n}\n\nexport function setLocale(locale) {\n  return (dispatch) => {\n    localStorage.setItem('BABELCHAT::LOCALE', locale);\n    dispatch(reduxSetLocale(locale));\n  };\n}\n\nexport function showSettings() {\n  return {\n    type: types.USER_SHOW_SETTINGS,\n  };\n}\n\nexport function signout() {\n  return {\n    type: types.USER_SIGNOUT,\n  };\n}\n\nexport function startStream(stream) {\n  return (dispatch, getState) => {\n    const { user: { isAudioMuted } } = getState();\n    if (isAudioMuted) {\n      stream.getAudioTracks()\n        .forEach((track) => { track.enabled = false; });\n    }\n    dispatch({\n      type: types.USER_START_STREAM,\n      payload: { stream },\n    });\n  };\n}\n\nexport function toggleAudio() {\n  return {\n    type: types.USER_TOGGLE_AUDIO,\n  };\n}\n","import diff from 'deep-diff';\nimport { recursive as merge } from 'merge';\nimport { loadTranslations, setLocale, syncTranslationWithStore } from 'react-redux-i18n';\nimport en from './en';\nimport es from './es';\n\nconst locales = {\n  en,\n  es,\n};\nconst availableLocales = Object.keys(locales);\nconst defaultLocale = 'en';\n\n// Populate locales with default literals\nconst translations = {};\navailableLocales.forEach((locale) => {\n  translations[locale] = merge(true, locales[defaultLocale], locales[locale]);\n});\n\n// Translations loader handler (for hot-reloading)\nexport const load = (store) => {\n  store.dispatch(loadTranslations(translations));\n};\n\nexport default (store) => {\n  // Locale Autodetection\n  const storedLocale = localStorage.getItem('BABELCHAT::LOCALE');\n  const browserLocale = (\n    (window.navigator.languages ? window.navigator.languages[0] : null)\n    || window.navigator.language\n    || window.navigator.browserLanguage\n    || window.navigator.userLanguage\n    || defaultLocale\n  ).substr(0, 2).toLowerCase();\n\n  let locale = defaultLocale;\n  if (~availableLocales.indexOf(storedLocale)) locale = storedLocale;\n  else if (~availableLocales.indexOf(browserLocale)) locale = browserLocale;\n\n  // Setup react-i18nify\n  syncTranslationWithStore(store);\n  load(store);\n  store.dispatch(setLocale(locale));\n\n  if (!__PRODUCTION__) {\n    // Warn about missing translations\n    const missing = availableLocales\n      .reduce((missing, locale) => {\n        if (locale === defaultLocale) {\n          return missing;\n        }\n        const keys = diff(locales[defaultLocale], locales[locale])\n          .reduce((missing, { kind, path }) => {\n            if (kind === 'E') {\n              return missing;\n            }\n            return [\n              ...missing,\n              path.join('.'),\n            ];\n          }, []);\n        if (!keys.length) {\n          return missing;\n        }\n        return [\n          ...missing,\n          `\\nMissing translations for \"${locale.toUpperCase()}\" locale:`,\n          ...keys,\n        ];\n      }, []);\n    if (missing.length) {\n      console.warn(missing.join('\\n'));\n    }\n  }\n};\n","export default {\n  NotFound: {\n    description: 'This is not the web page you\\'re looking for.',\n    goBack: 'Take me back home',\n  },\n  Room: {\n    joining: 'Joining room...',\n    welcome: 'Welcome to: \"%{name}\"',\n  },\n  Rooms: {\n    peers: '%{count}/%{limit} peers',\n  },\n  User: {\n    audioInput: 'Audio input',\n    settings: 'Settings',\n    saveSettings: 'Save settings',\n    signIn: 'Sign-In',\n    videoInput: 'Video input',\n  },\n};\n","export default {\n  NotFound: {\n    description: 'Esta no es la p치gina que est치s buscando.',\n    goBack: 'Vplver al inicio',\n  },\n  Room: {\n    joining: 'Entrando en la habitaci칩n...',\n    welcome: 'Bienvenido a: \"%{name}\"',\n  },\n  Rooms: {\n    peers: '%{count}/%{limit} personas',\n  },\n  User: {\n    signIn: 'Iniciar Sesi칩n',\n  },\n};\n","\nimport Touches from 'touches';\n\nclass FirstInteraction {\n  constructor() {\n    this.promises = [];\n    this.getPromise = this.getPromise.bind(this);\n    this.onKey = this.onKey.bind(this);\n    this.onPointer = this.onPointer.bind(this);\n    this.touches = Touches(window, {\n      filtered: true,\n      preventSimulated: false,\n    }).on('start', this.onPointer).on('end', this.onPointer);\n    window.addEventListener('keydown', this.onKey, false);\n    window.addEventListener('keyup', this.onKey, false);\n  }\n\n  getPromise() {\n    const { isReady, promises } = this;\n    return new Promise((resolve) => {\n      if (isReady) {\n        resolve();\n        return;\n      }\n      promises.push(resolve);\n    });\n  }\n\n  onFirstInteraction() {\n    const { promises, touches } = this;\n    touches.disable();\n    window.removeEventListener('keydown', this.onKey);\n    window.removeEventListener('keyup', this.onKey);\n    this.isReady = true;\n    promises.forEach(resolve => resolve());\n  }\n\n  onKey() {\n    this.onFirstInteraction();\n  }\n\n  onPointer() {\n    this.onFirstInteraction();\n  }\n}\n\nexport default (new FirstInteraction()).getPromise;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\nimport WaitForFirstInteraction from '@/services/firstInteraction';\n\nconst name = (\n  state = '',\n  action\n) => {\n  switch (action.type) {\n    case types.ROOM_JOIN:\n      return action.payload.name;\n    case types.ROOM_RESET:\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst peers = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case types.ROOM_JOIN:\n      state.forEach(({ connection }) => (\n        connection.destroy()\n      ));\n      return action.payload.peers;\n    case types.ROOM_PEER_JOIN:\n      return [\n        ...state,\n        action.payload.peer,\n      ];\n    case types.ROOM_PEER_LEAVE:\n      return state.filter(\n        ({ connection, peer }) => {\n          if (peer === action.payload.peer) {\n            connection.destroy();\n            return true;\n          }\n          return false;\n        }\n      );\n    case types.ROOM_PEER_POINTER:\n      return state.map(\n        (peer) => {\n          if (peer.peer === action.payload.peer) {\n            return {\n              ...peer,\n              pointer: action.payload.pointer,\n            };\n          }\n          return peer;\n        }\n      );\n    case types.ROOM_PEER_SIGNAL:\n      state.forEach(({ connection, peer }) => {\n        if (peer === action.payload.peer) {\n          connection.signal(action.payload.signal);\n        }\n      });\n      return state;\n    case types.ROOM_PEER_STREAM:\n      return state.map(\n        (peer) => {\n          if (peer.peer === action.payload.peer) {\n            const video = document.createElement('video');\n            video.srcObject = action.payload.stream;\n            video.onloadedmetadata = () => (\n              WaitForFirstInteraction()\n                .then(() => video.play())\n            );\n            return {\n              ...peer,\n              video,\n            };\n          }\n          return peer;\n        }\n      );\n    case types.USER_START_STREAM:\n      state.forEach(({ connection }) => {\n        connection.addStream(action.payload.stream);\n      });\n      return state;\n    case types.ROOM_RESET:\n      state.forEach(({ connection }) => (\n        connection.destroy()\n      ));\n      return [];\n    default:\n      return state;\n  }\n};\n\nconst photos = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case types.ROOM_JOIN:\n      return action.payload.photos;\n    case types.ROOM_ADD_PHOTO:\n      return [\n        ...state,\n        action.payload,\n      ];\n    case types.ROOM_MOVE_PHOTO:\n      return state.map((photo) => {\n        if (photo._id === action.payload.photo) {\n          return {\n            ...photo,\n            origin: {\n              x: action.payload.origin.x,\n              y: action.payload.origin.y,\n            },\n          };\n        }\n        return photo;\n      });\n    case types.ROOM_REMOVE_PHOTO:\n      return state.filter(({ _id }) => (_id !== action.payload.photo));\n    case types.ROOM_RESET:\n      return [];\n    default:\n      return state;\n  }\n};\n\nconst socket = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.ROOM_JOIN:\n      return action.payload.socket;\n    case types.ROOM_RESET:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst roomReducer = combineReducers({\n  name,\n  peers,\n  photos,\n  socket,\n});\n\nexport default roomReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\n\nconst list = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case types.ROOMS_FETCH_FULFILLED:\n      return action.payload.sort(({ name: a }, { name: b }) => a.localeCompare(b));\n    default:\n      return state;\n  }\n};\n\nconst roomsReducer = combineReducers({\n  list,\n});\n\nexport default roomsReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\nimport API from '@/services/api';\nimport WaitForFirstInteraction from '@/services/firstInteraction';\n\nconst localStoreKeyPrefix = 'BABELCHAT::';\nconst sessionKey = `${localStoreKeyPrefix}SESSION`;\nconst storedSession = JSON.parse(\n  localStorage.getItem(sessionKey) || 'false'\n);\nif (storedSession) {\n  API.setAuthorization(storedSession.token);\n}\n\nconst isAudioMuted = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_TOGGLE_AUDIO:\n      return !state;\n    default:\n      return state;\n  }\n};\n\nconst isAuth = (\n  state = !!storedSession,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n      return true;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst isShowingSettings = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_HIDE_SETTINGS:\n      return false;\n    case types.USER_SHOW_SETTINGS:\n      return true;\n    default:\n      return state;\n  }\n};\n\nconst profile = (\n  state = storedSession ? storedSession.profile : {},\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n      return action.payload.profile;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return {};\n    default:\n      return state;\n  }\n};\n\nconst settings = (\n  state = {\n    audioInput: localStorage.getItem(`${localStoreKeyPrefix}audioInput`) || '',\n    videoInput: localStorage.getItem(`${localStoreKeyPrefix}videoInput`) || '',\n  },\n  action\n) => {\n  switch (action.type) {\n    case types.USER_SAVE_SETTINGS: {\n      const { audioInput, videoInput } = action.payload;\n      localStorage.setItem(`${localStoreKeyPrefix}audioInput`, audioInput || '');\n      localStorage.setItem(`${localStoreKeyPrefix}videoInput`, videoInput || '');\n      return {\n        audioInput,\n        videoInput,\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nconst stream = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_START_STREAM:\n      return action.payload.stream;\n    case types.ROOM_RESET:\n      if (state) {\n        state.getTracks()\n          .forEach(track => track.stop());\n      }\n      return false;\n    case types.USER_TOGGLE_AUDIO:\n      if (state) {\n        state.getAudioTracks()\n          .forEach((track) => { track.enabled = !track.enabled; });\n      }\n      return state;\n    default:\n      return state;\n  }\n};\n\nconst token = (\n  state = storedSession ? storedSession.token : '',\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n      API.setAuthorization(action.payload.token);\n      localStorage.setItem(sessionKey, JSON.stringify(action.payload));\n      return action.payload.token;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      API.setAuthorization(false);\n      localStorage.removeItem(sessionKey);\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst video = (\n  state = false,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_START_STREAM: {\n      const video = document.createElement('video');\n      video.muted = true;\n      video.srcObject = action.payload.stream;\n      video.onloadedmetadata = () => (\n        WaitForFirstInteraction()\n          .then(() => video.play())\n      );\n      return video;\n    }\n    case types.ROOM_RESET:\n      if (state) {\n        state.srcObject = null;\n      }\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst userReducer = combineReducers({\n  isAudioMuted,\n  isAuth,\n  isShowingSettings,\n  profile,\n  settings,\n  stream,\n  token,\n  video,\n});\n\nexport default userReducer;\n","import { combineReducers } from 'redux';\nimport { i18nReducer as i18n } from 'react-redux-i18n';\nimport { loadingBarReducer as loadingBar } from 'react-redux-loading-bar';\nimport room from './room';\nimport rooms from './rooms';\nimport user from './user';\n\nconst rootReducer = combineReducers({\n  i18n,\n  loadingBar,\n  room,\n  rooms,\n  user,\n});\n\nexport default rootReducer;\n","import PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\nclass Video extends Component {\n  constructor(props) {\n    super(props);\n    this.dom = React.createRef();\n  }\n\n  componentDidMount() {\n    const { dom } = this;\n    const { video } = this.props;\n    dom.current.appendChild(video);\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  render() {\n    const { dom } = this;\n    return (\n      <div ref={dom} />\n    );\n  }\n}\n\nVideo.propTypes = {\n  // eslint-disable-next-line react/forbid-prop-types\n  video: PropTypes.object.isRequired,\n};\n\nexport default Video;\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport { TiTimes } from 'react-icons/ti';\nimport { connect } from 'react-redux';\nimport { Translate } from 'react-redux-i18n';\nimport styled from 'styled-components';\nimport { hideSettings as hide, saveSettings as save } from '@/actions/user';\n\nconst Overlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  width: 100%;\n  background: rgba(0, 0, 0, .75);\n  z-index: 100000;\n`;\n\nconst Wrapper = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -75%);\n  width: 400px;\n  display: flex;\n  flex-direction: column;\n  border-radius: 2px;\n`;\n\nconst Heading = styled.h2`\n  flex-shrink: 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 40px;\n  margin: 0;\n  font-size: 1.25em;\n  padding: 0 1rem;\n  background: #151515;\n  color: #eee;\n  border-radius: 2px 2px 0 0;\n  > a {\n    display: flex;\n    text-decoration: none;\n    font-size: 1.5em;\n    cursor: pointer;\n  }\n`;\n\nconst Form = styled.form`\n  padding: 1rem;\n  background: #eee;\n  color: #353535;\n  border-radius: 0 0 2px 2px;\n  > div {\n    margin-top: 0.5rem;\n    &:first-child {\n      margin-top: 0;    \n    }\n    > label {\n      font-weight: 700;\n    }\n    > select {\n      width: 100%;\n      padding: 0.5rem;\n      cursor: pointer;\n    }\n    > button {\n      margin: 1rem auto;\n      padding: 0.5rem 1rem;\n      cursor: pointer;\n    }\n    &.submit {\n      display: flex;\n    }\n  }\n`;\n\nclass Settings extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    navigator.mediaDevices.enumerateDevices()\n      .then((devices) => {\n        const audioInputs = devices.filter(({ kind }) => (kind === 'audioinput'));\n        const videoInputs = devices.filter(({ kind }) => (kind === 'videoinput'));\n        this.setState({\n          audioInputs,\n          videoInputs,\n        });\n      })\n      .catch(() => {});\n  }\n\n  onSubmit(e) {\n    const { hide, save } = this.props;\n    e.preventDefault();\n    const { target: form } = e;\n    const audioInput = form.audioInput.value;\n    const videoInput = form.videoInput.value;\n    save({ audioInput, videoInput });\n    hide();\n  }\n\n  render() {\n    const {\n      settings: {\n        audioInput,\n        videoInput,\n      },\n      hide,\n    } = this.props;\n    const {\n      audioInputs,\n      videoInputs,\n    } = this.state;\n    if (!audioInputs || !videoInputs) {\n      return null;\n    }\n    return (\n      <Overlay>\n        <Wrapper>\n          <Heading>\n            <Translate value=\"User.settings\" />\n            <a\n              onClick={() => hide()}\n            >\n              <TiTimes />\n            </a>\n          </Heading>\n          <Form onSubmit={this.onSubmit}>\n            <div>\n              <label><Translate value=\"User.audioInput\" /></label>\n              <select name=\"audioInput\" defaultValue={audioInput}>\n                {audioInputs.map(({ deviceId, label }) => (\n                  <option key={deviceId} value={deviceId}>{label}</option>\n                ))}\n              </select>\n            </div>\n            <div>\n              <label><Translate value=\"User.videoInput\" /></label>\n              <select name=\"videoInput\" defaultValue={videoInput}>\n                {videoInputs.map(({ deviceId, label }) => (\n                  <option key={deviceId} value={deviceId}>{label}</option>\n                ))}\n              </select>\n            </div>\n            <div className=\"submit\">\n              <button type=\"submit\">\n                <Translate value=\"User.saveSettings\" />\n              </button>\n            </div>\n          </Form>\n        </Wrapper>\n      </Overlay>\n    );\n  }\n}\n\nSettings.propTypes = {\n  settings: PropTypes.shape({\n    audioInput: PropTypes.string.isRequired,\n    videoInput: PropTypes.string.isRequired,\n  }).isRequired,\n  hide: PropTypes.func.isRequired,\n  save: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    user: { settings },\n  }) => ({\n    settings,\n  }),\n  {\n    hide,\n    save,\n  }\n)(Settings);\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport {\n  TiCog,\n  TiVolumeDown,\n  TiVolumeMute,\n  TiEject,\n} from 'react-icons/ti';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\nimport { showSettings, signout, toggleAudio } from '@/actions/user';\nimport API from '@/services/api';\nimport Video from '@/components/room/video';\nimport Settings from './settings';\n\nconst Wrapper = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n  background: #000;\n  width: 100px;\n  height: 100px;\n  vertical-align: middle;\n  box-shadow: 0 0 10px rgba(0, 0, 0, .5);\n  overflow: hidden;\n  .actions {\n    display: flex;\n    position: absolute;\n    bottom: -100%;\n    width: 100%;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 2em;\n    color: #eee;\n    transition: bottom ease-out .2s;\n    will-change: bottom;\n    > a {\n      cursor: pointer;\n      &:hover {\n        background: #eee;\n        color: #333;\n      }\n    }\n  }\n  &:hover .actions {\n    bottom: 0;\n  }\n`;\n\nconst User = ({\n  isAudioMuted,\n  isAuth,\n  isShowingSettings,\n  profile,\n  video,\n  showSettings,\n  signout,\n  toggleAudio,\n}) => (\n  isAuth ? (\n    <div>\n      <Wrapper>\n        {video && video.srcObject.getVideoTracks().length ? (\n          <Video\n            video={video}\n          />\n        ) : (\n          <img\n            src={`${API.baseURL}user/${profile._id}/photo?auth=${API.token}`}\n          />\n        )}\n        <div className=\"actions\">\n          <a onClick={toggleAudio}>\n            {isAudioMuted ? <TiVolumeMute /> : <TiVolumeDown />}\n          </a>\n          <a onClick={showSettings}>\n            <TiCog />\n          </a>\n          <a onClick={signout}>\n            <TiEject />\n          </a>\n        </div>\n      </Wrapper>\n      {isShowingSettings ? (\n        <Settings />\n      ) : null}\n    </div>\n  ) : null\n);\n\nUser.propTypes = {\n  isAudioMuted: PropTypes.bool.isRequired,\n  isAuth: PropTypes.bool.isRequired,\n  isShowingSettings: PropTypes.bool.isRequired,\n  profile: PropTypes.shape({\n    _id: PropTypes.string,\n  }).isRequired,\n  video: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]).isRequired,\n  showSettings: PropTypes.func.isRequired,\n  signout: PropTypes.func.isRequired,\n  toggleAudio: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    user: {\n      isAudioMuted,\n      isAuth,\n      isShowingSettings,\n      profile,\n      video,\n    },\n  }) => ({\n    isAudioMuted,\n    isAuth,\n    isShowingSettings,\n    profile,\n    video,\n  }),\n  {\n    showSettings,\n    signout,\n    toggleAudio,\n  }\n)(User);\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport LoadingBar from 'react-redux-loading-bar';\nimport styled from 'styled-components';\nimport User from './user';\n\nconst Route = styled.div`\n  display: flex;\n  height: 100vh;\n`;\n\nconst loadingBarStyle = {\n  backgroundColor: '#bebebe',\n};\n\nconst Layout = ({ children }) => (\n  <div>\n    <LoadingBar style={loadingBarStyle} />\n    <User />\n    <Route>\n      { children }\n    </Route>\n  </div>\n);\n\nLayout.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nexport default Layout;\n","import PropTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport { I18n } from 'react-redux-i18n';\nimport { connect } from 'react-redux';\nimport Touches from 'touches';\nimport { addWheelListener, removeWheelListener } from 'wheel';\nimport API from '@/services/api';\n\nclass Canvas extends Component {\n  constructor(props) {\n    super(props);\n    this.dom = React.createRef();\n    this.onDrop = this.onDrop.bind(this);\n    this.onPointerWheel = this.onPointerWheel.bind(this);\n    this.onResize = this.onResize.bind(this);\n    // This is what controls the viewport translation\n    this.origin = { x: 0, y: 0 };\n    // This is what controls the viewport scaling\n    this.scale = 1;\n    // The peer photos need to be downloaded from the API\n    // This is where we cache the loaded Image objects\n    this.peers = {};\n    // The photos are stored in the state as a base64 string\n    // We need to load the as Image objects in order to call ctx.drawImage\n    // (and also to extract their width & height for intersection testing)\n    // This is where we cache the loaded Image objects\n    this.photos = {};\n  }\n\n  componentDidMount() {\n    const { dom: { current: canvas } } = this;\n    // Load the inital set of photos\n    this.loadPhotos(this.props);\n    // Bind the events\n    canvas.addEventListener('dragover', Canvas.onDragOver, false);\n    canvas.addEventListener('drop', this.onDrop, false);\n    window.addEventListener('resize', this.onResize, false);\n    this.touches = Touches(window, {\n      filtered: true,\n      preventSimulated: false,\n    })\n      .on('start', this.onPointerStart.bind(this))\n      .on('move', this.onPointerMove.bind(this))\n      .on('end', this.onPointerEnd.bind(this));\n    addWheelListener(window, this.onPointerWheel);\n    // Initial resize (this will also call the initial draw)\n    this.onResize();\n  }\n\n  componentWillReceiveProps(props) {\n    // The redux state has changed...\n    // Load photos as Image objects and store them in the cache\n    this.loadPhotos(props);\n    // Redraw\n    this.draw(props);\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentWillUnmount() {\n    const { dom: { current: canvas }, touches } = this;\n    // We're unloading the room\n    // Unbind all event handlers\n    touches.disable();\n    canvas.removeEventListener('dragover', Canvas.onDragOver);\n    canvas.removeEventListener('drop', this.onDrop);\n    removeWheelListener(window, this.onPointerWheel);\n    window.removeEventListener('resize', this.onResize);\n  }\n\n  static onDragOver(e) {\n    e.preventDefault();\n  }\n\n  onDrop(e) {\n    // The user dropped a file into the canvas\n    const { socket } = this.props;\n    const {\n      clientX,\n      clientY,\n      dataTransfer: { files: [file] },\n    } = e;\n    e.preventDefault();\n    // We're only interested in files\n    if (!file) {\n      return;\n    }\n    // Get the screen-space pointer in room-space\n    const origin = this.getPointer([clientX, clientY]);\n    // Read the file\n    const reader = new FileReader();\n    reader.onload = () => {\n      // Once it loads, send it to the room server:\n      socket.send(JSON.stringify({\n        type: 'ROOM/ADD_PHOTO',\n        payload: {\n          origin,\n          photo: reader.result.substr(reader.result.indexOf('base64') + 7),\n        },\n      }));\n    };\n    reader.readAsDataURL(file);\n  }\n\n  onPointerStart(e, pointer) {\n    const { photos, socket } = this.props;\n    const button = e.button || 0;\n    const { x, y } = this.getPointer(pointer);\n\n    // Get photo at pointer\n    const intersects = photos\n      .filter(({ _id, origin }) => {\n        const image = this.photos[_id];\n        // Filter it out if it hasn't been loaded\n        // yet into the cache as an Image object\n        if (!image) {\n          return false;\n        }\n        const { width, height } = image;\n        if (\n          x < origin.x\n          || x > origin.x + width\n          || y < origin.y\n          || y > origin.y + height\n        ) {\n          // The pointer is outside the bounds\n          return false;\n        }\n        // We got a hit!\n        return true;\n      });\n    // Reverse the filtered photos to get\n    // the one renderded on top first\n    intersects.reverse();\n    const photo = intersects[0];\n\n    if (\n      // Clicking the canvas (or right click)\n      // will drag it's origin\n      (button === 0 && !photo)\n      || (button === 2)\n    ) {\n      this.dragging = {\n        canvas: pointer,\n      };\n    } else if (\n      // Left click drags/removes photos\n      button === 0 && photo\n    ) {\n      if (e.shiftKey) {\n        // Shift+Click will remove the photo\n        socket.send(JSON.stringify({\n          type: 'ROOM/REMOVE_PHOTO',\n          payload: {\n            photo: photo._id,\n          },\n        }));\n      } else {\n        // Left click will drag the photo\n        this.dragging = {\n          offset: {\n            x: photo.origin.x - x,\n            y: photo.origin.y - y,\n          },\n          photo,\n        };\n      }\n    }\n  }\n\n  onPointerMove(e, pointer) {\n    const { dragging, origin, scale } = this;\n    const { peers } = this.props;\n    const { x, y } = this.getPointer(pointer);\n    peers.forEach(({ connection }) => {\n      if (\n        connection._channel\n        && connection._channel.readyState === 'open'\n      ) {\n        connection.send(new Int32Array([x, y]));\n      }\n    });\n    if (!dragging) {\n      return;\n    }\n    if (dragging.canvas) {\n      // Translate the canvas origin\n      origin.x += (pointer[0] - dragging.canvas[0]) / scale;\n      origin.y += (pointer[1] - dragging.canvas[1]) / scale;\n      dragging.canvas = pointer;\n    }\n    if (dragging.photo) {\n      // Translate the photo\n      const { offset, photo } = dragging;\n      photo.origin.x = x + offset.x;\n      photo.origin.y = y + offset.y;\n    }\n    // Redraw\n    this.draw();\n  }\n\n  onPointerEnd() {\n    const { dragging } = this;\n    const { socket } = this.props;\n    if (!dragging) {\n      return;\n    }\n    delete this.dragging;\n    if (dragging.photo) {\n      // Send the final translation to the server\n      // So it gets saved into the db and broadcasted to the peers\n      const { _id: photo, origin } = dragging.photo;\n      socket.send(JSON.stringify({\n        type: 'ROOM/MOVE_PHOTO',\n        payload: {\n          origin,\n          photo,\n        },\n      }));\n    }\n  }\n\n  onPointerWheel({ deltaY }) {\n    // Zoom the canvas in and out when the mouse wheel moves\n    const normalized = 1 + (Math.min(Math.max(-deltaY, -1), 1) * 0.075);\n    this.scale *= normalized;\n    this.scale = Math.min(Math.max(this.scale, 0.25), 2);\n    // Redraw\n    this.draw();\n  }\n\n  onResize() {\n    // Resize the canvas\n    const { dom: { current: canvas } } = this;\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n    // Redraw\n    this.draw();\n  }\n\n  getPointer([x, y]) {\n    // Convert coordinates from screen-space to room-space\n    const { dom: { current: canvas }, origin, scale } = this;\n    return {\n      x: Math.round(((x - (canvas.width * 0.5)) / scale) - origin.x),\n      y: Math.round(((y - (canvas.height * 0.5)) / scale) - origin.y),\n    };\n  }\n\n  loadPhotos({ peers, photos }) {\n    // Go through all the peers in the redux state\n    peers.forEach(({ _id }) => {\n      // If it's not already in the cache, load it as an Image object\n      if (!this.peers[_id]) {\n        const img = new Image();\n        img.src = `${API.baseURL}user/${_id}/photo?auth=${API.token}`;\n        img.onload = () => (\n          // Redraw once it's loaded into the cache\n          this.draw()\n        );\n        this.peers[_id] = img;\n      }\n    });\n    // Go through all the photos in the redux state\n    photos.forEach(({ _id, photo }) => {\n      // If it's not already in the cache, load it as an Image object\n      if (!this.photos[_id]) {\n        const img = new Image();\n        img.src = `data:image/jpeg;base64,${photo}`;\n        img.onload = () => (\n          // Redraw once it's loaded into the cache\n          this.draw()\n        );\n        this.photos[_id] = img;\n      }\n    });\n  }\n\n  draw(props) {\n    const { dom: { current: canvas }, origin, scale } = this;\n    const { name, peers, photos } = props || this.props;\n    const ctx = canvas.getContext('2d');\n    // Reset canvas context\n    canvas.width = canvas.width;\n    // Room-space coordinates start at the middle of the canvas\n    ctx.translate(canvas.width * 0.5, canvas.height * 0.5);\n    // Apply user scale\n    ctx.scale(scale, scale);\n    // Apply user translation\n    ctx.translate(origin.x, origin.y);\n    // Draw room name at 0,0\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = '#999';\n    ctx.font = '32px Arial';\n    ctx.fillText(I18n.t(`Room.${name ? 'welcome' : 'joining'}`, { name }), 0, 0);\n    // Go through all the photos in the redux state\n    photos.forEach(({ _id, origin }) => {\n      // Check the cache to see if the photo has been\n      // already loaded as an Image object by \"loadPhotos\"\n      if (this.photos[_id]) {\n        // Draw the cached Image object\n        ctx.drawImage(this.photos[_id], origin.x, origin.y);\n      }\n    });\n    // Go through all the peers in the redux state\n    peers.forEach(({ _id, pointer }) => {\n      // Check the cache to see if the peer photo has been\n      // already loaded as an Image object by \"loadPhotos\"\n      // and if we have received a pointer position\n      if (this.peers[_id] && pointer) {\n        const [x, y] = pointer;\n        // Scale size with viewport\n        const radius = 24 / scale;\n        // Draw outer circle\n        ctx.beginPath();\n        ctx.arc(x, y, radius, 0, 2 * Math.PI);\n        ctx.fill();\n        // Clipping mask circle\n        ctx.save();\n        ctx.beginPath();\n        ctx.arc(x, y, radius * 0.9, 0, 2 * Math.PI);\n        ctx.clip();\n        // Draw the cached Image object\n        ctx.drawImage(this.peers[_id], x - radius, y - radius, radius * 2, radius * 2);\n        ctx.restore();\n      }\n    });\n  }\n\n  render() {\n    const { dom } = this;\n    return (\n      <canvas ref={dom} />\n    );\n  }\n}\n\nCanvas.propTypes = {\n  // eslint-disable-next-line react/no-unused-prop-types\n  name: PropTypes.string.isRequired,\n  peers: PropTypes.arrayOf(PropTypes.shape({\n    _id: PropTypes.string.isRequired,\n    connection: PropTypes.object.isRequired,\n    pointer: PropTypes.arrayOf(PropTypes.number),\n  })).isRequired,\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    origin: PropTypes.shape({\n      x: PropTypes.number.isRequired,\n      y: PropTypes.number.isRequired,\n    }),\n    photo: PropTypes.string.isRequired,\n  })).isRequired,\n  socket: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]).isRequired,\n};\n\nexport default connect(\n  ({\n    room: {\n      name,\n      peers,\n      photos,\n      socket,\n    },\n  }) => ({\n    name,\n    peers,\n    photos,\n    socket,\n  })\n)(Canvas);\n","import PropTypes from 'prop-types';\nimport { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { hideLoading, showLoading } from 'react-redux-loading-bar';\nimport { withRouter } from 'react-router';\nimport WebSocket from 'reconnecting-websocket';\nimport Peer from 'simple-peer';\nimport {\n  addPhoto,\n  join,\n  movePhoto,\n  removePhoto,\n  reset,\n  peerJoin,\n  peerLeave,\n  peerPointer,\n  peerSignal,\n  peerStream,\n} from '@/actions/room';\nimport { startStream } from '@/actions/user';\nimport * as types from '@/actions/types';\nimport API from '@/services/api';\n\nclass Events extends Component {\n  constructor(props) {\n    super(props);\n    this.onMessage = this.onMessage.bind(this);\n  }\n\n  componentWillMount() {\n    const {\n      match: { params: { slug } },\n      settings: {\n        audioInput,\n        videoInput,\n      },\n      startStream,\n    } = this.props;\n\n    // Connect to room server\n    this.connectToServer(slug);\n\n    // Open audio+video stream\n    navigator.mediaDevices.getUserMedia({\n      audio: audioInput ? { deviceId: { exact: audioInput } } : true,\n      video: {\n        width: 640,\n        height: 640,\n        ...(videoInput ? { deviceId: { exact: videoInput } } : { facingMode: 'user' }),\n      },\n    })\n      .then(startStream)\n      .catch(() => {\n        // Failed to get video stream.. Try with just audio\n        navigator.mediaDevices.getUserMedia({\n          audio: true,\n          video: false,\n        })\n          .then(startStream)\n          .catch(() => {});\n      });\n  }\n\n  componentWillReceiveProps({ match: { params: { slug } } }) {\n    const {\n      match: { params: { slug: currentSlug } },\n      reset,\n    } = this.props;\n    if (currentSlug !== slug) {\n      reset();\n      this.connectToServer(slug);\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentWillUnmount() {\n    const { socket } = this;\n    const { hideLoading, reset } = this.props;\n    if (socket.readyState === WebSocket.CONNECTING) {\n      hideLoading();\n    }\n    socket.close(1000);\n    reset();\n  }\n\n  onMessage({ data }) {\n    const { socket } = this;\n    const {\n      addPhoto,\n      history,\n      join,\n      movePhoto,\n      peerJoin,\n      peerLeave,\n      peerSignal,\n      removePhoto,\n    } = this.props;\n    let event;\n    try {\n      event = JSON.parse(data);\n    } catch (e) {\n      return;\n    }\n    switch (event.type) {\n      case types.ROOM_ADD_PHOTO:\n        addPhoto(event.payload);\n        break;\n      case types.ROOM_MOVE_PHOTO:\n        movePhoto(event.payload);\n        break;\n      case types.ROOM_REMOVE_PHOTO:\n        removePhoto(event.payload);\n        break;\n      case types.ROOM_JOIN:\n        join({\n          ...event.payload,\n          peers: event.payload.peers.map(peer => this.connectToPeer(peer, true)),\n          socket,\n        });\n        break;\n      case types.ROOM_PEER_JOIN:\n        peerJoin(this.connectToPeer(event.payload));\n        break;\n      case types.ROOM_PEER_LEAVE:\n        peerLeave(event.payload);\n        break;\n      case types.ROOM_PEER_SIGNAL:\n        peerSignal(event.payload);\n        break;\n      case types.ROOM_ERROR:\n        history.replace(\n          event.payload === 'FULL_ROOM' ? '/rooms' : '/404'\n        );\n        break;\n      default:\n        break;\n    }\n  }\n\n  connectToServer(room) {\n    const {\n      hideLoading,\n      showLoading,\n    } = this.props;\n    if (this.socket) {\n      if (this.socket.readyState === WebSocket.CONNECTING) {\n        hideLoading();\n      }\n      this.socket.close(1000);\n    }\n    showLoading();\n    this.socket = new WebSocket(\n      `${API.baseURL.replace(/http/, 'ws')}room/${room}`,\n      API.token\n    );\n    this.socket.onopen = () => {\n      this.socket.onclose = null;\n      this.socket.onerror = null;\n      hideLoading();\n    };\n    this.socket.onmessage = this.onMessage;\n  }\n\n  connectToPeer(peer, initiator = false) {\n    const { socket } = this;\n    const { stream, peerPointer, peerStream } = this.props;\n    peer.connection = new Peer({\n      initiator,\n      stream,\n    });\n    peer.connection.on('signal', (signal) => {\n      socket.send(JSON.stringify({\n        type: 'ROOM/PEER_SIGNAL',\n        payload: {\n          peer: peer.peer,\n          signal,\n        },\n      }));\n    });\n    peer.connection.on('data', ({ buffer }) => (\n      peerPointer({ peer: peer.peer, pointer: [...(new Int32Array(buffer))] })\n    ));\n    peer.connection.on('stream', stream => (\n      peerStream({ peer: peer.peer, stream })\n    ));\n    return peer;\n  }\n\n  render() {\n    return null;\n  }\n}\n\nEvents.propTypes = {\n  /* eslint-disable react/forbid-prop-types */\n  history: PropTypes.object.isRequired,\n  /* eslint-enable react/forbid-prop-types */\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      slug: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  settings: PropTypes.shape({\n    audioInput: PropTypes.string.isRequired,\n    videoInput: PropTypes.string.isRequired,\n  }).isRequired,\n  stream: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]).isRequired,\n  addPhoto: PropTypes.func.isRequired,\n  hideLoading: PropTypes.func.isRequired,\n  join: PropTypes.func.isRequired,\n  movePhoto: PropTypes.func.isRequired,\n  removePhoto: PropTypes.func.isRequired,\n  reset: PropTypes.func.isRequired,\n  peerJoin: PropTypes.func.isRequired,\n  peerLeave: PropTypes.func.isRequired,\n  peerPointer: PropTypes.func.isRequired,\n  peerSignal: PropTypes.func.isRequired,\n  peerStream: PropTypes.func.isRequired,\n  showLoading: PropTypes.func.isRequired,\n  startStream: PropTypes.func.isRequired,\n};\n\nexport default withRouter(connect(\n  ({ user: { settings, stream } }) => ({ settings, stream }),\n  {\n    addPhoto,\n    hideLoading,\n    join,\n    movePhoto,\n    removePhoto,\n    reset,\n    peerJoin,\n    peerLeave,\n    peerPointer,\n    peerSignal,\n    peerStream,\n    showLoading,\n    startStream,\n  }\n)(Events));\n","import * as types from './types';\n\nexport function addPhoto({ _id, origin, photo }) {\n  return {\n    type: types.ROOM_ADD_PHOTO,\n    payload: { _id, origin, photo },\n  };\n}\n\nexport function movePhoto({ origin, photo }) {\n  return {\n    type: types.ROOM_MOVE_PHOTO,\n    payload: { origin, photo },\n  };\n}\n\nexport function join({\n  name,\n  peers,\n  photos,\n  socket,\n}) {\n  return {\n    type: types.ROOM_JOIN,\n    payload: {\n      name,\n      peers,\n      photos,\n      socket,\n    },\n  };\n}\n\nexport function peerJoin(peer) {\n  return {\n    type: types.ROOM_PEER_JOIN,\n    payload: { peer },\n  };\n}\n\nexport function peerLeave({ peer }) {\n  return {\n    type: types.ROOM_PEER_LEAVE,\n    payload: { peer },\n  };\n}\n\nexport function peerPointer({ peer, pointer }) {\n  return {\n    type: types.ROOM_PEER_POINTER,\n    payload: { peer, pointer },\n  };\n}\n\nexport function peerSignal({ peer, signal }) {\n  return {\n    type: types.ROOM_PEER_SIGNAL,\n    payload: { peer, signal },\n  };\n}\n\nexport function peerStream({ peer, stream }) {\n  return {\n    type: types.ROOM_PEER_STREAM,\n    payload: { peer, stream },\n  };\n}\n\nexport function removePhoto({ photo }) {\n  return {\n    type: types.ROOM_REMOVE_PHOTO,\n    payload: { photo },\n  };\n}\n\nexport function reset() {\n  return {\n    type: types.ROOM_RESET,\n  };\n}\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\nimport API from '@/services/api';\nimport Video from './video';\n\nconst Listing = styled.div`\n  position: absolute;\n  top: 100px;\n  right: 0;\n  > img, > div > video {\n    display: block;\n    background: #000;\n    width: 100px;\n    height: 100px;\n    vertical-align: middle;\n    box-shadow: 0 0 10px rgba(0, 0, 0, .5);\n  }\n`;\n\nconst Peers = ({ peers }) => (\n  <Listing>\n    {peers.map(({\n      _id,\n      peer,\n      video,\n    }) => (\n      video && video.srcObject.getVideoTracks().length ? (\n        <Video\n          key={peer}\n          video={video}\n        />\n      ) : (\n        <img\n          key={peer}\n          src={`${API.baseURL}user/${_id}/photo?auth=${API.token}`}\n        />\n      )\n    ))}\n  </Listing>\n);\n\nPeers.propTypes = {\n  peers: PropTypes.arrayOf(PropTypes.shape({\n    _id: PropTypes.string.isRequired,\n    peer: PropTypes.string.isRequired,\n    video: PropTypes.object,\n  })).isRequired,\n};\n\nexport default connect(\n  ({\n    room: { peers },\n  }) => ({\n    peers,\n  })\n)(Peers);\n","import React from 'react';\nimport Canvas from '@/components/room/canvas';\nimport Events from '@/components/room/events';\nimport Peers from '@/components/room/peers';\n\nconst Room = () => (\n  <div>\n    <Canvas />\n    <Events />\n    <Peers />\n  </div>\n);\n\nexport default Room;\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { Translate } from 'react-redux-i18n';\nimport { Link } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { fetch } from '@/actions/rooms';\n\nconst Listing = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 512px;\n  margin: 0 auto;\n  background: #fff;\n  > a {\n    display: flex;\n    box-sizing: border-box;\n    width: 100%;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 1.5em;\n    padding: 0.5rem 1rem;\n    color: #000;\n    text-decoration: none;\n    &.full {\n      opacity: 0.5;\n      pointer-events: none;\n    }\n    > strong > img {\n      width: 1.5rem;\n      height: 1.125rem;\n      margin-right: 1rem;\n      vertical-align: middle;\n    }\n    &:hover {\n      background: #bbb;\n    }\n  }\n  > h1 {\n    box-sizing: border-box;\n    width: 100%;\n    margin: 0 0 1rem;\n    padding: 1rem;\n    border-bottom: 1px solid #aaa;\n  }\n`;\n\nclass Rooms extends PureComponent {\n  componentDidMount() {\n    const { fetch } = this.props;\n    fetch();\n  }\n\n  render() {\n    const { list } = this.props;\n    return (\n      <Listing>\n        <h1>Rooms</h1>\n        {list.map(({\n          flag,\n          name,\n          peerLimit,\n          peers,\n          slug,\n        }) => (\n          <Link\n            key={slug}\n            to={{ pathname: `/${slug}` }}\n            className={peers >= peerLimit ? 'full' : ''}\n          >\n            <strong>\n              <img\n                src={`${__COUNTRY_FLAGS_CDN__}${flag}.svg`}\n              />\n              {name}\n            </strong>\n            <Translate\n              count={peers}\n              limit={peerLimit}\n              value=\"Rooms.peers\"\n            />\n          </Link>\n        ))}\n      </Listing>\n    );\n  }\n}\n\nRooms.propTypes = {\n  list: PropTypes.arrayOf(PropTypes.shape({\n    flag: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    peerLimit: PropTypes.number.isRequired,\n    peers: PropTypes.number.isRequired,\n    slug: PropTypes.string.isRequired,\n  })).isRequired,\n  fetch: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    rooms: { list },\n  }) => ({\n    list,\n  }),\n  {\n    fetch,\n  }\n)(Rooms);\n","import API from '@/services/api';\nimport * as types from './types';\n\n// eslint-disable-next-line import/prefer-default-export\nexport function fetch() {\n  return {\n    type: types.ROOMS_FETCH,\n    payload: API.fetch({\n      endpoint: 'rooms',\n    }),\n  };\n}\n","import styled from 'styled-components';\n\nexport default styled.button`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0.5rem 1rem;\n  margin: 0;\n  background-color: ${props => (props.primary ? '#eee' : '#333')};\n  color: ${props => (props.primary ? '#333' : '#eee')};\n  border: 1px solid #151515;\n  border-radius: 2px;\n  outline: 0;\n  font-family: inherit;\n  font-size: inherit;\n  font-weight: 700;\n  transition: background-color ease-out .2s, opacity ease-out .2s;\n  will-change: background-color, opacity;\n  cursor: pointer;\n  > span {\n    margin-left: 0.5rem;\n  }\n  &:hover {\n    background-color: ${props => (props.primary ? '#fff' : '#555')};\n  }\n`;\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport { TiSocialGooglePlus } from 'react-icons/ti';\nimport { connect } from 'react-redux';\nimport { Translate } from 'react-redux-i18n';\nimport styled from 'styled-components';\nimport { refreshSession } from '@/actions/user';\nimport Button from '@/components/ui/button';\nimport API from '@/services/api';\n\nconst Wrapper = styled.div`\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst Box = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n  background: #bebebe;\n  border: 1px solid #000;\n  padding: 3rem 6rem;\n  > button {\n    width: 100%;\n    font-size: 1rem;\n    align-items: center;\n    justify-content: flex-start;\n    > svg {\n      font-size: 2rem;\n      margin-right: 0.75rem;\n    }\n  }\n`;\n\nclass Login extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.loginWithGoogle = this.loginWithGoogle.bind(this);\n    this.onMessage = this.onMessage.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener('message', this.onMessage, false);\n  }\n\n  componentWillUnmount() {\n    const { popupWatcher } = this;\n    window.removeEventListener('message', this.onMessage);\n    if (popupWatcher) {\n      clearInterval(popupWatcher);\n      delete this.popupWatcher;\n    }\n  }\n\n  onMessage({ origin, data: { session } }) {\n    const { popupWatcher } = this;\n    const { refreshSession } = this.props;\n    if (API.baseURL.indexOf(origin) === 0) {\n      clearInterval(popupWatcher);\n      delete this.popupWatcher;\n      if (session) {\n        refreshSession(session);\n      }\n    }\n  }\n\n  loginWithGoogle({ screenX, screenY }) {\n    const w = 512;\n    const h = 512;\n    const left = (screenX || (window.screen.width / 2)) - (w / 2);\n    const top = (screenY || (window.screen.height / 2)) - (h / 2);\n    const win = window.open(\n      `${API.baseURL}user/google`,\n      'loginWithGoogle',\n      `width=${w},height=${h},top=${top},left=${left}`\n    );\n    if (this.popupWatcher) {\n      clearInterval(this.popupWatcher);\n    }\n    this.popupWatcher = setInterval(() => {\n      if (!win.window) {\n        clearInterval(this.popupWatcher);\n        delete this.popupWatcher;\n        return;\n      }\n      win.postMessage(true, API.baseURL);\n    }, 100);\n  }\n\n  render() {\n    return (\n      <Wrapper>\n        <Box>\n          <Button\n            type=\"button\"\n            onClick={this.loginWithGoogle}\n          >\n            <TiSocialGooglePlus />\n            <Translate value=\"User.signIn\" />\n          </Button>\n        </Box>\n      </Wrapper>\n    );\n  }\n}\n\nLogin.propTypes = {\n  refreshSession: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  () => ({}),\n  {\n    refreshSession,\n  }\n)(Login);\n","import React from 'react';\nimport { TiArrowBack } from 'react-icons/ti';\nimport { Translate } from 'react-redux-i18n';\nimport { Link } from 'react-router-dom';\nimport styled from 'styled-components';\nimport Button from '@/components/ui/button';\n\nconst Wrapper = styled.div`\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst Status = styled.div`\n  font-size: 6em;\n  line-height: 0.8em;\n  color: #656565;\n  margin-bottom: 2rem;\n`;\n\nconst Description = styled.div`\n  font-size: 1.5em;\n`;\n\nconst Alternative = styled.div`\n  margin: 2rem 0 4rem;\n  > a {\n    text-decoration: none;\n    font-size: 1.2em;\n  }\n`;\n\nconst NotFound = () => (\n  <Wrapper>\n    <Status>\n      404\n    </Status>\n    <Description>\n      <Translate value=\"NotFound.description\" />\n    </Description>\n    <Alternative>\n      <Link to={{ pathname: '/' }}>\n        <Button\n          type=\"button\"\n          primary\n        >\n          <TiArrowBack />\n          <Translate value=\"NotFound.goBack\" />\n        </Button>\n      </Link>\n    </Alternative>\n  </Wrapper>\n);\n\nexport default NotFound;\n","import React from 'react';\nimport { hot } from 'react-hot-loader';\nimport { connect } from 'react-redux';\nimport { Route as RouteComponent, Redirect, Switch } from 'react-router-dom';\nimport Layout from '@/layout';\nimport Room from './room';\nimport Rooms from './rooms';\nimport Login from './login';\nimport NotFound from './404';\n\nconst Route = connect(\n  ({ user: { isAuth } }) => ({ isAuth })\n)(({\n  component: Component,\n  isAuth,\n  requiresAuth,\n  requiresNoAuth,\n  ...rest\n}) => {\n  const isForbidden = (\n    (requiresAuth && !isAuth)\n    || (requiresNoAuth && isAuth)\n  );\n  return (\n    <RouteComponent\n      {...rest}\n      render={props => (\n        (isForbidden) ? (\n          <Redirect to={isAuth ? '/' : '/login'} />\n        ) : (\n          <Component {...props} />\n        )\n      )}\n    />\n  );\n});\n\nconst Root = () => (\n  <Layout>\n    <Switch>\n      <Route exact path=\"/404\" component={NotFound} />\n      <Route exact path=\"/login\" component={Login} requiresNoAuth />\n      <Route exact path=\"/rooms\" component={Rooms} requiresAuth />\n      <Route exact path=\"/:slug\" component={Room} requiresAuth />\n      <Redirect exact from=\"/\" to=\"/rooms\" />\n      <Route path=\"*\" component={NotFound} />\n    </Switch>\n  </Layout>\n);\n\nexport default hot(module)(Root);\n","import { createHashHistory } from 'history';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { applyMiddleware, createStore, compose as productionCompose } from 'redux';\nimport promiseMiddleware from 'redux-promise-middleware';\nimport { Provider } from 'react-redux';\nimport { loadingBarMiddleware } from 'react-redux-loading-bar';\nimport { Router } from 'react-router-dom';\nimport thunkMiddleware from 'redux-thunk';\nimport { refreshSession } from '@/actions/user';\nimport syncTranslationWithStore, { load as reloadLocales } from '@/locales';\nimport rootReducer from '@/reducers';\nimport Root from '@/routes';\n\nconst devCompose = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;\nconst compose = !__PRODUCTION__ && devCompose ? devCompose : productionCompose;\nconst store = createStore(\n  rootReducer,\n  {},\n  compose(\n    applyMiddleware(thunkMiddleware, promiseMiddleware, loadingBarMiddleware())\n  )\n);\nsyncTranslationWithStore(store);\n\nif (store.getState().user.isAuth) {\n  store.dispatch(refreshSession());\n}\n\nconst history = createHashHistory({\n  basename: __BASENAME__,\n});\nconst mount = document.getElementById('mount');\nrender(\n  <Provider store={store}>\n    <Router history={history}>\n      <Root />\n    </Router>\n  </Provider>,\n  mount\n);\n\nwindow.addEventListener('contextmenu', e => (\n  e.preventDefault()\n), false);\n\nif (!__PRODUCTION__ && module.hot) {\n  module.hot.accept('@/locales', () => reloadLocales(store));\n  module.hot.accept('@/reducers', () => store.replaceReducer(rootReducer));\n}\n"],"sourceRoot":""}